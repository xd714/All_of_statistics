<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 4: Expectation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #667eea 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '📊∫μ⚡🎯';
            position: absolute;
            top: 50%;
            left: -25%;
            transform: translateY(-50%);
            font-size: 4em;
            opacity: 0.1;
            animation: expectation 15s ease-in-out infinite;
        }

        @keyframes expectation {
            0%, 100% { left: -25%; transform: translateY(-50%) rotate(0deg); }
            50% { left: 125%; transform: translateY(-50%) rotate(180deg); }
        }

        .header h1 {
            position: relative;
            z-index: 1;
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            position: relative;
            z-index: 1;
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            padding: 30px;
            border-radius: 15px;
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-left: 5px solid #667eea;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .section h2 {
            color: #2c3e50;
            font-size: 2em;
            margin-bottom: 20px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            display: inline-block;
        }

        .expect-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin: 25px 0;
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.3);
            text-align: center;
        }

        .formula-box {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            padding: 20px;
            border-radius: 15px;
            margin: 15px 0;
            border: 2px solid #f39c12;
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            box-shadow: 0 8px 20px rgba(243, 156, 18, 0.2);
        }

        .example-box {
            background: linear-gradient(135deg, #e0c3fc 0%, #9bb5ff 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 15px 0;
            border: 2px solid #9c88ff;
            box-shadow: 0 8px 20px rgba(156, 136, 255, 0.2);
        }

        .model-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .model-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
            transition: all 0.3s ease;
        }

        .model-card:hover {
            transform: scale(1.02);
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }

        .warning-card {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            padding: 30px 40px;
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }

        .nav-btn {
            padding: 12px 25px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 25px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .nav-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        table {
            width: 100%; 
            border-collapse: collapse; 
            background: white; 
            border-radius: 10px; 
            overflow: hidden;
        }

        th {
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        td {
            padding: 12px; 
            border-bottom: 1px solid #eee;
        }

        tr:nth-child(even) {
            background: #f8f9fa;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Chapter 4: Expectation</h1>
            <p>The Mathematical Foundation of Averages and Centers</p>
        </div>

        <div class="content">
            <div class="section">
                <h2>🎯 What is Expectation?</h2>
                
                <div class="expect-box">
                    <h4>📊 The Center of Mass</h4>
                    <p><strong>Expectation E[X]:</strong> The average value of a random variable</p>
                    <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                        Think of it as the "center of mass" of the probability distribution
                    </div>
        </div>

          <p><strong>Also called:</strong> Mean, expected value, first moment</p>
                </div>

                <div class="model-grid">
                    <div class="model-card">
                        <h5>📈 Discrete Case</h5>
                        <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                            E[X] = ∑ x f(x)
                        </div>
                        <p><strong>Sum over all possible values</strong></p>
                        <p><strong>Weight each value by its probability</strong></p>
                    </div>

                    <div class="model-card">
                        <h5>📊 Continuous Case</h5>
                        <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                            E[X] = ∫_{-∞}^∞ x f(x) dx
                        </div>
                        <p><strong>Integrate over all possible values</strong></p>
                        <p><strong>Weight each value by density</strong></p>
                    </div>
                </div>

                <div class="example-box">
                    <h4>🎲 Simple Examples</h4>
                    <div class="formula-box">
                        <strong>Fair die:</strong> E[X] = (1+2+3+4+5+6)/6 = 3.5
                        <br><strong>Coin flip:</strong> E[X] = 0×(1/2) + 1×(1/2) = 0.5
                        <br><strong>Uniform(0,1):</strong> E[X] = ∫₀¹ x dx = 1/2
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>⚡ Properties of Expectation</h2>

                <div class="expect-box">
                    <h4>🔧 Linearity - The Most Important Property</h4>
                    <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                        E[aX + bY] = aE[X] + bE[Y]
                    </div>
                    <p><strong>Works regardless of dependence between X and Y!</strong></p>
                </div>

                <div class="model-grid">
                    <div class="model-card">
                        <h5>📊 Basic Properties</h5>
                        <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                            E[c] = c (constant)
                            <br>E[X + c] = E[X] + c
                            <br>E[aX] = aE[X]
                        </div>
                    </div>

                    <div class="model-card">
                        <h5>📈 Monotonicity</h5>
                        <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                            If X ≤ Y, then E[X] ≤ E[Y]
                        </div>
                        <p><strong>Larger random variables have larger expectations</strong></p>
                    </div>

                    <div class="model-card">
                        <h5>⚡ Triangle Inequality</h5>
                        <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                            |E[X]| ≤ E[|X|]
                        </div>
                        <p><strong>Expectation of absolute value ≥ absolute value of expectation</strong></p>
                    </div>

                    <div class="model-card">
                        <h5>🔄 Independence Property</h5>
                        <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                            If X ⊥ Y: E[XY] = E[X]E[Y]
                        </div>
                        <p><strong>Only works when X and Y are independent!</strong></p>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>🧮 Law of the Unconscious Statistician (LOTUS)</h2>

                <div class="expect-box">
                    <h4>🎯 Computing E[g(X)] Without Finding the Distribution of g(X)</h4>
                    <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                        <strong>Discrete:</strong> E[g(X)] = ∑ g(x) f(x)
                        <br><strong>Continuous:</strong> E[g(X)] = ∫ g(x) f(x) dx
                    </div>
                    <p><strong>Key insight:</strong> Use original distribution of X, not derived distribution of g(X)</p>
                </div>

                <div class="example-box">
                    <h4>📊 LOTUS Examples</h4>
                    <div class="formula-box">
                        <strong>E[X²] for X ~ Uniform(0,1):</strong>
                        <br>E[X²] = ∫₀¹ x² · 1 dx = [x³/3]₀¹ = 1/3
                        
                        <br><br><strong>E[eˣ] for X ~ N(0,1):</strong>
                        <br>E[eˣ] = ∫_{-∞}^∞ eˣ · (1/√(2π)) e^(-x²/2) dx = e^(1/2)
                    </div>
                </div>

                <div class="model-grid">
                    <div class="model-card">
                        <h5>🎲 Common Applications</h5>
                        <ul>
                            <li><strong>Moments:</strong> E[X^k] for k = 2,3,4,...</li>
                            <li><strong>Variance:</strong> E[X²] - (E[X])²</li>
                            <li><strong>MGF:</strong> E[e^(tX)]</li>
                            <li><strong>Transformations:</strong> E[sin(X)], E[log(X)], etc.</li>
                        </ul>
                    </div>

                    <div class="model-card">
                        <h5>⚠️ When LOTUS Doesn't Apply</h5>
                        <ul>
                            <li><strong>Multiple variables:</strong> Need joint distribution for E[g(X,Y)]</li>
                            <li><strong>Conditional expectations:</strong> E[g(X)|Y] requires conditional distribution</li>
                            <li><strong>Infinite expectations:</strong> When ∫|g(x)|f(x)dx = ∞</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>📏 Variance and Standard Deviation</h2>

                <div class="expect-box">
                    <h4>📊 Measuring Spread Around the Mean</h4>
                    <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                        Var(X) = E[(X - μ)²] = E[X²] - (E[X])²
                    </div>
                    <p><strong>μ = E[X], and SD(X) = √Var(X)</strong></p>
                </div>

                <div class="model-grid">
                    <div class="model-card">
                        <h5>⚡ Properties of Variance</h5>
                        <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                            Var(c) = 0
                            <br>Var(X + c) = Var(X)
                            <br>Var(aX) = a²Var(X)
                        </div>
                        <p><strong>Adding constants doesn't change spread</strong></p>
                    </div>

                    <div class="model-card">
                        <h5>🔄 Independence and Variance</h5>
                        <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                            If X ⊥ Y: Var(X ± Y) = Var(X) + Var(Y)
                        </div>
                        <p><strong>Variances add for independent variables</strong></p>
                        <p><strong>Note:</strong> Sign doesn't matter!</p>
                    </div>

                    <div class="model-card">
                        <h5>📊 Computational Formula</h5>
                        <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                            Var(X) = E[X²] - (E[X])²
                        </div>
                        <p><strong>Often easier than definition</strong></p>
                        <p><strong>Compute E[X] and E[X²] separately</strong></p>
                    </div>

                    <div class="model-card">
                        <h5>🎯 Why Variance Matters</h5>
                        <ul>
                            <li><strong>Risk assessment:</strong> Higher variance = higher uncertainty</li>
                            <li><strong>Quality control:</strong> Low variance = consistent performance</li>
                            <li><strong>Confidence intervals:</strong> Width depends on variance</li>
                            <li><strong>Hypothesis testing:</strong> Test statistics involve variance</li>
                        </ul>
                    </div>
                </div>

                <div class="example-box">
                    <h4>📈 Variance Examples</h4>
                    <div class="formula-box">
                        <strong>Bernoulli(p):</strong> Var(X) = p(1-p), maximized at p = 1/2
                        <br><strong>Uniform(a,b):</strong> Var(X) = (b-a)²/12
                        <br><strong>Normal(μ,σ²):</strong> Var(X) = σ²
                        <br><strong>Poisson(λ):</strong> Var(X) = λ (same as mean!)
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>🔄 Conditional Expectation</h2>

                <div class="expect-box">
                    <h4>🎯 Expectation Given Information</h4>
                    <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                        E[X|Y] = ∫ x f(x|y) dx
                    </div>
                    <p><strong>Note:</strong> E[X|Y] is a random variable (function of Y)</p>
                </div>

                <div class="model-grid">
                    <div class="model-card">
                        <h5>📊 Law of Total Expectation</h5>
                        <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                            E[X] = E[E[X|Y]]
                        </div>
                        <p><strong>Powerful tool for calculating expectations</strong></p>
                        <p><strong>Strategy:</strong> Condition on convenient variable Y</p>
                    </div>

                    <div class="model-card">
                        <h5>🔧 Properties</h5>
                        <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                            E[g(Y)|Y] = g(Y)
                            <br>E[g(Y)X|Y] = g(Y)E[X|Y]
                            <br>E[X|Y] = E[X] if X ⊥ Y
                        </div>
                    </div>
                </div>

                <div class="example-box">
                    <h4>🎲 Example: Total Expectation</h4>
                    <p><strong>Setup:</strong> Roll die, then flip that many coins. Find E[number of heads].</p>
                    <div class="formula-box">
                        <strong>Let N = die result, X = number of heads</strong>
                        <br>E[X|N=n] = n/2 (each coin has prob 1/2 for heads)
                        <br>E[X] = E[E[X|N]] = E[N/2] = E[N]/2 = 3.5/2 = 1.75
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>⚡ Moment Generating Functions</h2>

                <div class="expect-box">
                    <h4>🎯 The Ultimate Tool for Moments</h4>
                    <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                        M_X(t) = E[e^(tX)]
                    </div>
                    <p><strong>If it exists, it uniquely determines the distribution</strong></p>
                </div>

                <div class="model-grid">
                    <div class="model-card">
                        <h5>🧮 Getting Moments</h5>
                        <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                            E[X^k] = M_X^(k)(0)
                        </div>
                        <p><strong>Take k-th derivative, evaluate at t=0</strong></p>
                        <p><strong>Example:</strong> μ = M'(0), σ² = M''(0) - (M'(0))²</p>
                    </div>

                    <div class="model-card">
                        <h5>🔄 Properties</h5>
                        <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                            M_{aX+b}(t) = e^(bt) M_X(at)
                            <br>If X ⊥ Y: M_{X+Y}(t) = M_X(t)M_Y(t)
                        </div>
                        <p><strong>Sums of independent variables: multiply MGFs</strong></p>
                    </div>
                </div>

                <div class="example-box">
                    <h4>📊 Common MGFs</h4>
                    <table>
                        <tr>
                            <th>Distribution</th>
                            <th>MGF</th>
                            <th>Mean</th>
                            <th>Variance</th>
                        </tr>
                        <tr>
                            <td><strong>Bernoulli(p)</strong></td>
                            <td>1-p + pe^t</td>
                            <td>p</td>
                            <td>p(1-p)</td>
                        </tr>
                        <tr>
                            <td><strong>Normal(μ,σ²)</strong></td>
                            <td>exp(μt + σ²t²/2)</td>
                            <td>μ</td>
                            <td>σ²</td>
                        </tr>
                        <tr>
                            <td><strong>Exponential(λ)</strong></td>
                            <td>λ/(λ-t) for t < λ</td>
                            <td>1/λ</td>
                            <td>1/λ²</td>
                        </tr>
                        <tr>
                            <td><strong>Poisson(λ)</strong></td>
                            <td>exp(λ(e^t - 1))</td>
                            <td>λ</td>
                            <td>λ</td>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="section">
                <h2>📊 Important Inequalities</h2>

                <div class="model-grid">
                    <div class="model-card">
                        <h5>📈 Markov's Inequality</h5>
                        <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                            P(X ≥ a) ≤ E[X]/a
                        </div>
                        <p><strong>For non-negative X and a > 0</strong></p>
                        <p><strong>Crude but very general bound</strong></p>
                    </div>

                    <div class="model-card">
                        <h5>📊 Chebyshev's Inequality</h5>
                        <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                            P(|X - μ| ≥ kσ) ≤ 1/k²
                        </div>
                        <p><strong>At least 75% within 2 standard deviations</strong></p>
                        <p><strong>At least 89% within 3 standard deviations</strong></p>
                    </div>

                    <div class="model-card">
                        <h5>⚡ Jensen's Inequality</h5>
                        <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                            <strong>Convex g:</strong> E[g(X)] ≥ g(E[X])
                            <br><strong>Concave g:</strong> E[g(X)] ≤ g(E[X])
                        </div>
                        <p><strong>Examples:</strong> E[X²] ≥ (E[X])², E[log X] ≤ log(E[X])</p>
                    </div>

                    <div class="model-card">
                        <h5>🎯 Cauchy-Schwarz</h5>
                        <div class="formula-box" style="background: rgba(255,255,255,0.2);">
                            (E[XY])² ≤ E[X²]E[Y²]
                        </div>
                        <p><strong>Equality when Y = aX for some constant a</strong></p>
                        <p><strong>Foundation for correlation theory</strong></p>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>⚠️ Common Pitfalls</h2>

                <div class="model-grid">
                    <div class="model-card warning-card">
                        <h5>❌ E[1/X] ≠ 1/E[X]</h5>
                        <p><strong>Expectation is not linear for reciprocals</strong></p>
                        <p><strong>Example:</strong> If X = 1 or 2 equally likely, E[X] = 1.5 but E[1/X] = 3/4</p>
                        <p><strong>General rule:</strong> E[g(X)] ≠ g(E[X]) unless g is linear</p>
                    </div>

                    <div class="model-card warning-card">
                        <h5>❌ Independence Assumption</h5>
                        <p><strong>E[XY] = E[X]E[Y] only when independent</strong></p>
                        <p><strong>Wrong:</strong> Always assuming this holds</p>
                        <p><strong>Right:</strong> Check independence first</p>
                    </div>

                    <div class="model-card warning-card">
                        <h5>❌ Existence Issues</h5>
                        <p><strong>Not all random variables have finite expectation</strong></p>
                        <p><strong>Example:</strong> Cauchy distribution has E[X] undefined</p>
                        <p><strong>Check:</strong> ∫|x|f(x)dx < ∞ for existence</p>
                    </div>

                    <div class="model-card warning-card">
                        <h5>❌ Confusing E[X|Y] and E[X]</h5>
                        <p><strong>E[X|Y] is random (depends on Y)</strong></p>
                        <p><strong>E[X] is constant</strong></p>
                        <p><strong>Relationship:</strong> E[E[X|Y]] = E[X]</p>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>🔗 Connections to Other Chapters</h2>

                <div class="model-grid">
                    <div class="example-box">
                        <h5>📊 To Random Variables (Chapter 3)</h5>
                        <p><strong>Foundation:</strong> Expectation is a functional of distributions</p>
                        <p><strong>LOTUS:</strong> Computing expectations without changing variables</p>
                        <p><strong>Moments:</strong> Characterizing distributions through expectations</p>
                    </div>

                    <div class="example-box">
                        <h5>🎯 To Convergence (Chapter 6)</h5>
                        <p><strong>Law of Large Numbers:</strong> Sample means converge to expectations</p>
                        <p><strong>Central Limit Theorem:</strong> Distribution of sample means</p>
                        <p><strong>Convergence of expectations:</strong> When does E[X_n] → E[X]?</p>
                    </div>

                    <div class="example-box">
                        <h5>📈 To Estimation (Chapter 8)</h5>
                        <p><strong>Method of moments:</strong> Equate sample and population moments</p>
                        <p><strong>Bias and variance:</strong> Properties of estimators</p>
                        <p><strong>Risk functions:</strong> Expected loss</p>
                    </div>

                    <div class="example-box">
                        <h5>🔄 To Regression (Chapter 14)</h5>
                        <p><strong>Conditional expectation:</strong> E[Y|X] is the regression function</p>
                        <p><strong>Best prediction:</strong> Minimizes mean squared error</p>
                        <p><strong>Linear regression:</strong> Best linear approximation to E[Y|X]</p>
                    </div>
                </div>
            </div>
                    <div class="nav-buttons">
            <a href="#" class="nav-btn">← Chapter 3: Random Variables</a>
            <a href="#" class="nav-btn">Chapter 5: Inequalities →</a>
        </div>
    </div>
</body>
</html>
          